"use strict";angular.module("mkm.seaCrimeData",["ngRoute"]).service("seattleDataGov",["$http","$q",function($http,$q){function processIncidentData(data){function indexUpdate(_report_){function updateIndex(typeStr,currentChildren){if("VEH-THEFT-AUTO"!==typeStr)for(var newChildren=getChildType(typeStr),i=newChildren.length-1;i>=0;i--){var childType=newChildren[i];currentChildren.hasOwnProperty(childType)?currentChildren[childType].count++:currentChildren[childType]={$type:childType,count:1}}return currentChildren}function getChildType(typeStr){for(var q=typeStr,childTypes=[];-1!==q.lastIndexOf("-");)childTypes.push(q.slice(q.lastIndexOf("-")+1,q.length)),q=q.slice(0,q.lastIndexOf("-"));return childTypes}var offType=_report_.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));if(_index_.hasOwnProperty(parentType)){var childrenNow=_index_[parentType].children;_index_[parentType].children=updateIndex(offType,childrenNow),_index_[parentType].count++}else void 0!==parentType&&(_index_[parentType]={count:1,offenseCategory:"VEH-THEFT-AUTO"===offType?offType:parentType,show:!0,children:null},_index_[parentType].children=updateIndex(offType,{}))}function plotsAddReport(_report_){var _longitude=Number(_report_.longitude),_latitude=Number(_report_.latitude);_mapBounds.extend(new google.maps.LatLng(_latitude,_longitude)),_plots_.push({type:"Feature",geometry:{type:"Point",coordinates:[_longitude,_latitude]},properties:_report_})}for(var _index_={},_plots_=[],i=data.length-1;i>=0;i--)plotsAddReport(data[i]),indexUpdate(data[i]);return function(){var d3Colour=d3.scale.category20().domain(d3.keys(_index_));for(var key in _index_)_index_[key].fillColor=d3Colour(key)}(),{reports:_plots_,index:_index_}}var _mapBounds=new google.maps.LatLngBounds,_http=$http({method:"GET",url:"scripts/sea-crime/7ais-f98f.json"}),_promise=$q.defer();return _http.then(function(response){var processedData=processIncidentData(response.data);_promise.resolve({incidents:processedData.reports,index:processedData.index,mapBounds:_mapBounds})}),_promise}]).directive("filterReportTypes",[function(){function link(scope,element){var filterInd=element.attr("filter-report-types"),filterMap=element.attr("crime-map-filter"),filterTime=element.attr("crime-timeline-filter");scope.updated=!1,scope.filterPushSplice=function($event){$event.cancelBubble=!0,this.val.show=!this.val.show,scope.updated=!0},scope.filterApply=function($event){$event.preventDefault();var _index=this.mapIndexFilter();"function"==typeof this.mapIndexFilter&&this[filterMap].update(_index),"function"==typeof this[filterTime].filterData&&this[filterTime].filterData(_index),scope.updated=!1},scope.filterClear=function($event){$event.preventDefault(),$event.cancelBubble=!0;for(var key in this[filterInd])this[filterInd][key].show=!1;scope.updated=!1},scope.filterReset=function($event){$event.preventDefault(),$event.cancelBubble=!0;for(var key in this[filterInd])this[filterInd][key].show=!0;scope.updated=!0},scope.mapIndexFilter=function(){var _index_=this[filterInd]||{},filteredArray=[];for(var key in _index_)_index_[key].show||filteredArray.push(key);return filteredArray}}return{link:link,templateUrl:"views/template-crime-map-filter.html"}}]).directive("summaryList",[function(){return{templateUrl:"views/template-summary-list.html"}}]).directive("crimeReportsSummary",[function(){function link(scope,element){var summaryType=element.attr("crime-reports-summary"),summaryIndex=element.attr("summary-index");scope[summaryType]={data:null,filtered:!1,renderChart:function(reportTypes){scope[summaryType].data=reportTypes,scope.$apply()}},scope.clearTypeDetail=function($event){scope[summaryType].data=null},scope.filterTypeDetail=function($event){if(scope[summaryType].filtered=!scope[summaryType].filtered,scope[summaryType].filtered){var d=scope[summaryType].data,offenseCategory="VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory;scope.filterClear($event),scope[summaryIndex][offenseCategory].show=!0,scope.filterApply($event)}else scope.filterReset($event),scope.filterApply($event)}}return{link:link,templateUrl:"/views/template-reports-summary.html"}}]).directive("crimeReportsBlock",[function(){function link(scope,element){var blockID=element.attr("crime-reports-block"),promiseAttr=element.attr("crime-reports-data"),wrapper=d3.select(element[0]),padding=.025*element[0].offsetWidth,wdth=element[0].offsetWidth,hght=element[0].offsetHeight,barHght=.5*hght,svg=wrapper.append("svg").attr({height:hght,width:wdth}),scaleAxisX=d3.scale.ordinal().rangeBands([padding,wdth-padding]),scaleAxisY=d3.scale.linear().range([padding,barHght]),crimeReportData=scope[promiseAttr];crimeReportData.promise.then(function(data){function setTypeDetail(d){scope.$typeDetail.renderChart(d)}var _index_=data.index,indexArr=[];for(var ind in _index_)indexArr.push(_index_[ind]);var indexSorted=indexArr.sort(function(a,b){return a.count>b.count?1:a.count<b.count?-1:0}),axisTitles=[];indexSorted.forEach(function(d){axisTitles.push("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory)}),scaleAxisX.domain(axisTitles.reverse()),scaleAxisY.domain([0,d3.max(indexSorted,function(d){return d.count})]);var indexRect=svg.selectAll("g.reports-index-rect").data(indexSorted).enter().append("g").attr("id",function(d){return d.offenseCategory}).attr("class","reports-index-rect").attr("transform","translate("+padding+",50)");indexRect.append("rect").attr("class","").attr("transform",function(d){var scaleVal=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+scaleVal+","+2*(barHght-padding)+") rotate(180)"}).attr("y",function(d){return barHght-padding}).attr("width",scaleAxisX.rangeBand()).attr("height",function(d){return scaleAxisY(d.count)}).attr("fill",function(d){return d.fillColor}).on("click",setTypeDetail),indexRect.append("text").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.33*scaleAxisX.rangeBand())+", "+(barHght-padding+9)+") rotate(-33)"}).attr("text-anchor","end").attr("class","block-label category").text(function(d){return d.offenseCategory}).on("click",setTypeDetail),indexRect.append("text").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.67*scaleAxisX.rangeBand()-4)+", "+(barHght-scaleAxisY(d.count)-padding-2)+")"}).attr("class","block-label count").text(function(d){return d.count}).on("click",setTypeDetail),scope[blockID]={refreshBlocks:function(){var padding=.025*element[0].offsetWidth,wdth=element[0].offsetWidth,hght=element[0].offsetHeight,barHght=.75*hght;svg.attr({height:hght,width:wdth}),scaleAxisX.rangeBands([padding,wdth-padding]),scaleAxisY.range([padding,barHght]),indexRect.selectAll(".block-label.category").transition().duration(100).ease("sin-in-out").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.33*scaleAxisX.rangeBand())+", "+(barHght-padding+7)+") rotate(-50)"}),indexRect.selectAll(".block-label.count").transition().duration(100).ease("sin-in-out").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.67*scaleAxisX.rangeBand()-4)+", "+(barHght-scaleAxisY(d.count)-padding-2)+")"}),indexRect.selectAll("g.reports-index-rect rect").transition().duration(100).ease("sin-in-out").attr("transform",function(d){var scaleVal=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+scaleVal+","+2*(barHght-padding)+") rotate(180)"}).attr("y",function(d){return barHght-padding}).attr("width",scaleAxisX.rangeBand()).attr("height",function(d){return scaleAxisY(d.count)})}}})}return{link:link,templateUrl:"views/template-reports-block.html"}}]).directive("vizTimeLine",[function(){function link(scope,element){function plotXcirc(d){var incidentDate=new Date(d.properties.date_reported).toDateString(),_q_=scaleAxisX(new Date(incidentDate));return _q_}function plotYcirc(d){var incidentDate=new Date(d.properties.date_reported),incidentTime=incidentDate.toTimeString();return scaleAxisY(new Date("Wed Dec 31 1969 "+incidentTime))}var vizID=element.attr("viz-time-line"),mapID=element.attr("crime-viz-map"),promiseAttr=element.attr("viz-time-data"),wrapper=d3.select(element[0]),padding=.05*element[0].offsetWidth,wdth=element[0].offsetWidth,hght=element[0].offsetHeight,svg=wrapper.append("svg").attr({height:hght,width:wdth}),timeFormatMD=d3.time.format("%m/%d"),timeFormatFull=d3.time.format("%A at %H:%M"),scaleAxisX=d3.time.scale().range([0,wdth]),scaleAxisY=d3.time.scale().domain([new Date("Wed Dec 31 1969 00:00:00"),new Date("Wed Dec 31 1969 24:00:00")]).range([padding,hght-padding]),xAxis=d3.svg.axis().orient("bottom").innerTickSize(-wdth).outerTickSize(0).tickPadding(10).tickFormat(timeFormatMD),yAxis=d3.svg.axis().orient("left").innerTickSize(-(hght+padding)).outerTickSize(0).tickPadding(10).tickFormat(d3.time.format("%H")).ticks(d3.time.hours,1),crimeReportData=scope[promiseAttr];scope.toolTipLock=scope.toolTipLock||!1,crimeReportData.promise.then(function(data){function toolTipShow(data,element){try{scope[mapID].$markers.close()}catch(e){}var incident=data,circ=void 0!==element?element:reportMarks.selectAll("circle").filter(function(d){return d.properties.general_offense_number===incident.general_offense_number})[0][0];if("transparent"!==circ.getAttribute("fill")){circ.setAttribute("r","4"),toolTipEl.html(timeFormatFull(new Date(incident.date_reported))+" / "+incident.offense_type);var parent=circ.parentElement,parentbounding=parent.getBoundingClientRect(),bounding=circ.getBoundingClientRect(),newWdth=bounding.left,newHght=bounding.top,toolTipHght=toolTipEl[0][0].getBoundingClientRect().height,offsetX=newWdth-parentbounding.left,offsetY=newHght-parentbounding.top+toolTipHght+24;toolTipEl.style("left",function(){return offsetX+"px"}).style("top",function(){return offsetY+"px"}),toolTipEl.transition().duration(200).style("opacity",1).style("background",function(){var offType=incident.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));return _index[parentType].fillColor}).attr("transform","translate("+padding+","+(hght-30)+")")}}function toolTipHide(){toolTipEl.transition().duration(500).style("opacity",0),reportMarks.selectAll("circle").transition().duration(250).attr("r","4"),scope.toolTipLock=!1,scope[mapID].$markers=null;try{scope[mapID].$markers.close()}catch(e){}}var toolTipEl=d3.select("#cicle-tool-tip"),_incidents=data.incidents,_index=data.index,dateRange=d3.extent(_incidents,function(d){return new Date(d.properties.date_reported).valueOf()});_incidents[0];scaleAxisX.domain(dateRange),scaleAxisX.nice(d3.time.day),xAxis.scale(scaleAxisX),yAxis.scale(scaleAxisY),svg.append("g").attr("class","axis x").attr("transform","translate("+1.75*padding+","+(hght-30)+")").call(xAxis),svg.append("g").attr("class","axis y").attr("transform","translate("+padding+", 0)").call(yAxis);var reportMarks=svg.append("g").attr("id","reports-vz-marks").attr("transform","translate("+1.75*padding+", 0)");reportMarks.selectAll("circle").data(_incidents).enter().append("circle").attr("class","timeline-circle").attr("fill",function(d){var offType=d.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));return _index[parentType].fillColor}).attr("cx",plotXcirc).attr("cy",plotYcirc).attr("r",4).on("click",function(event){toolTipShow(event.properties,this),scope.toolTipLock=!0;var offType=event.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),_latitude=Number(event.properties.latitude),_longitude=Number(event.properties.longitude),uluru={lat:_latitude,lng:_longitude};null!==scope[mapID].markers&&scope[mapID].markers.setMap(null);var _marker=new google.maps.Marker({position:uluru,map:scope[mapID].$g,icon:"images/spacer.png"}),_HTMLcontent='<span class="glyphicon glyphicon-map-marker" style="color: '+scope.$index[parentType].fillColor+'"></span>&nbsp;'+event.properties.summarized_offense_description,infowindow=new google.maps.InfoWindow({content:_HTMLcontent});if(infowindow.open(scope[mapID].$g,_marker),google.maps.event.addListener(infowindow,"closeclick",function(){scope.incidentDetail=null,scope.$apply(),toolTipHide()}),scope[mapID].$g.setCenter(_marker.getPosition()),scope[mapID].$markers=infowindow,scope.incidentDetail=event.properties,scope.$apply(),void 0!==scope.$detailMap){var StreetView=new google.maps.Map(document.getElementById("street-view-detail"),{scrollwheel:!1,zoomControl:!1,zoom:0}),panorama=new google.maps.StreetViewPanorama(document.getElementById("street-view-detail"),{position:uluru,pov:{heading:34,pitch:5},scrollwheel:!1});StreetView.setStreetView(panorama)}}).on("mouseover",function(d){scope.toolTipLock||(toolTipShow(d.properties,this),this.setAttribute("r","8"))}).on("mouseout",function(d){scope.toolTipLock||toolTipHide()}),scope[vizID]={filterData:function(filterIndex){reportMarks.selectAll("circle").transition().duration(200).attr("cx",function(d){var offType=d.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));if(filterIndex.indexOf(parentType)<0){var incidentDate=new Date(d.properties.date_reported).toDateString(),_q_=scaleAxisX(new Date(incidentDate));return _q_}return 0}).attr("fill",function(d){var offType=d.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));return filterIndex.indexOf(parentType)<0?_index[parentType].fillColor:"transparent"})},refresh:function(){var newPadding=.05*element[0].offsetWidth,newWdth=element[0].offsetWidth,newHght=element[0].offsetHeight;svg.attr({height:newHght,width:newWdth}),scaleAxisX.range([newPadding,newWdth-2*newPadding]),scaleAxisY.range([newPadding,newHght-newPadding]),svg.select("g#reports-vz-marks").transition().duration(100).attr("transform","translate("+1.75*newPadding+", 0)"),svg.select(".axis.x").transition().duration(100).attr("transform","translate("+1.75*newPadding+","+(newHght-30)+")").ease("sin-in-out").call(xAxis),svg.select(".axis.y").transition().duration(100).ease("sin-in-out").call(yAxis),reportMarks.selectAll("circle").transition().duration(200).attr("cx",plotXcirc).attr("cy",plotYcirc)},toolTipHide:function(){toolTipHide()},toolTipShow:function(incident){toolTipShow(incident)}}})}return{link:link,templateUrl:"views/template-reports-viz.html"}}]).directive("mapCanvas",[function(){function link(scope,element){var mapID=element.attr("map-canvas"),promiseAttr=element.attr("map-promise"),vizID=element.attr("map-timeline"),crimeReportData=scope[promiseAttr];scope[mapID]={$g:null},crimeReportData.promise.then(function(data){function plotstyleBasic(feature){if(void 0!==scope[mapID].$g&&void 0!==scope[mapID].$g){var offType=feature.f.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),offense=scope.$index[parentType];return{icon:{path:google.maps.SymbolPath.CIRCLE,scale:3,fillColor:offense.fillColor,fillOpacity:1,strokeWeight:0}}}}function markerClick(event){scope.toolTipLock=!0;var currentFiltered=scope.mapIndexFilter(),offType=event.feature.f.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));if(-1===currentFiltered.indexOf(parentType)){var _incident=event.feature.f,_latitude=Number(_incident.latitude),_longitude=Number(_incident.longitude),uluru={lat:_latitude,lng:_longitude};null!==scope[mapID].markers&&scope[mapID].markers.setMap(null);var _marker=new google.maps.Marker({position:uluru,map:scope[mapID].$g,icon:"images/spacer.png"}),_HTMLcontent='<span class="glyphicon glyphicon-map-marker" style="color: '+scope.$index[parentType].fillColor+'"></span>&nbsp;'+_incident.summarized_offense_description,infowindow=new google.maps.InfoWindow({content:_HTMLcontent});if(infowindow.open(scope[mapID].$g,_marker),google.maps.event.addListener(infowindow,"closeclick",function(){scope.incidentDetail=null,scope.$apply(),scope[vizID].toolTipHide()}),scope[mapID].$g.setCenter(_marker.getPosition()),scope[mapID].markers=infowindow,scope.incidentDetail=_incident,scope.$apply(),scope[vizID].toolTipShow(_incident),void 0!==scope.$detailMap){var StreetView=new google.maps.Map(document.getElementById("street-view-detail"),{scrollwheel:!1,zoomControl:!1,zoom:0}),panorama=new google.maps.StreetViewPanorama(document.getElementById("street-view-detail"),{position:uluru,pov:{heading:34,pitch:5},scrollwheel:!1});StreetView.setStreetView(panorama)}}}scope.toolTipLock=scope.toolTipLock||!1,scope[mapID].markers=null,scope.markerOver=null,scope[mapID].refresh=function(){scope[mapID].$g.fitBounds(data.mapBounds)},scope[mapID].$g=new google.maps.Map(document.getElementById("map-canvas"),{scrollwheel:!1,streetViewControl:!1,mapTypeControl:!1,panControl:!1}),scope[mapID].$g.setOptions({styles:[{stylers:[{hue:"#fff"},{saturation:-100}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"on"}]}]}),scope[mapID].$g.data.addGeoJson({type:"FeatureCollection",features:data.incidents}),scope[mapID].$g.data.setStyle(plotstyleBasic),scope[mapID].$g.data.addListener("click",function($event){markerClick($event)}),scope[mapID].$g.fitBounds(data.mapBounds),scope[mapID].update=function(indexArray){function indexSelected(feature){var offType=feature.f.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),filterOffence=indexArray.indexOf(parentType)>-1,offenseHex=scope.$index[parentType].fillColor;return{icon:{path:google.maps.SymbolPath.CIRCLE,scale:2.75,fillColor:filterOffence?"transparent":offenseHex,fillOpacity:filterOffence?0:1,strokeWeight:0,zIndex:filterOffence?100:1}}}scope[mapID].$g.data.setStyle(indexSelected)}})}return{link:link,templateUrl:"views/template-map-canvas.html"}}]).directive("incidentDetail",[function(){function link(scope,element){var mapID=element.attr("map-id"),vizID=element.attr("timeline-id");scope.incidentDetail=null,null!==document.getElementById("street-view-detail")&&(scope.$detailMap=new google.maps.Map(document.getElementById("street-view-detail"),{zoom:14})),scope.closeDetail=function(){try{scope[mapID].$markers.close()}catch(e){}scope[vizID].toolTipHide(),this.incidentDetail=null}}return{link:link,templateUrl:"views/template-incident-detail.html"}}]).filter("orderObjectBy",function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){return a[field]>b[field]?1:-1}),reverse&&filtered.reverse(),filtered}}),angular.module("mkm.seaCrimeData").config(["$routeProvider",function($routeProvider){$routeProvider.when("/seattle-crime-map",{templateUrl:"views/crime-view.html",controller:"CrimeMapCtrl"}).otherwise({redirectTo:"/seattle-crime-map"})}]).controller("CrimeMapCtrl",["$scope","seattleDataGov",function($scope,seattleDataGov){$scope.crimeData=seattleDataGov,$scope.crimeData.promise.then(function(data){$scope.$index=data.index,$scope.$reports=data.incidents})}]),angular.module("mkm.seaCrimeData").run(["$templateCache",function($templateCache){$templateCache.put("views/crime-view.html",'<div class="container-fluid"> <div class="row" incident-detail="crimeData" timeline-id="$vizTimeline" map-id="$crimeMap" ng-hide="incidentDetail === null"> </div> <div class="row"> <div class="col-md-1" uib-dropdown> <div id="filter-types" uib-dropdown-toggle class="btn-group"> <button type="button" class="btn btn-default"> <span class="glyphicon glyphicon-filter"></span> </button> </div> <ul filter-report-types="$index" crime-map-filter="$crimeMap" crime-timeline-filter="$vizTimeline" uib-dropdown-menu role="menu" aria-labelledby="filter-types"> </ul> </div> <div class="col-md-5"> <div id="sea-crime-viz" viz-time-line="$vizTimeline" viz-time-data="crimeData" crime-viz-map="$crimeMap"></div> </div> <div class="col-md-5"> <br> <div map-canvas="$crimeMap" map-promise="crimeData" map-timeline="$vizTimeline"></div> </div> </div> <div class="row"> <div class="col-md-12" crime-reports-summary="$typeDetail" summary-index="$index"></div> </div> <div class="row"> <div class="col-md-10 col-md-offset-1"> <div id="crime-reports-block" crime-reports-block="$vizBlocks" crime-reports-data="crimeData"></div> </div> </div> </div>'),$templateCache.put("views/template-crime-map-filter.html",'<li> <div class="btn-group btn-group-sm" role="group" aria-label="..."> <button type="button" ng-class="updated ? \'btn btn-primary\' : \'btn btn-default\'" ng-click="filterApply($event)">Apply</button> <button type="button" class="btn btn-default" ng-click="filterReset($event)" ng-show="mapIndexFilter().length > 0">Reset</button> <button type="button" class="btn btn-default" ng-click="filterClear($event)" ng-hide="$indexLength() === mapIndexFilter().length">Clear All</button> </div> </li> <li id="type-filter"> <form id="crime-reports-block" id="crime-map-filter"> <div class="radio" ng-repeat="(key, val) in $index | orderObjectBy : \'count\' : true"> <label ng-click="filterPushSplice($event)"> <input type="checkbox" ng-checked="val.show"> {{val.offenseCategory}} <span class="badge" style="background-color: {{val.fillColor}}">&nbsp;</span> </label> </div> </form> </li>'),$templateCache.put("views/template-incident-detail.html",'<div class="col-md-5 col-md-offset-1"> <div class="table-responsive"> <table class="table"> <thead> <tr> <td>Date Reported</td> <td>Address</td> <td>District Sector</td> <td>Census Tract</td> <td>General Offense Number</td> <td>Offense Type</td> <td>Offense Code</td> <td>Description</td> <td>Zone/Beat</td> </tr> </thead> <tbody> <tr> <td>{{incidentDetail.date_reported | date:\'medium\'}}</td> <td>{{incidentDetail.hundred_block_location}}</td> <td>{{incidentDetail.district_sector}}</td> <td>{{incidentDetail.census_tract_2000}}</td> <td>{{incidentDetail.general_offense_number}}</td> <td>{{incidentDetail.offense_type}}</td> <td>{{incidentDetail.offense_code}}</td> <td>{{incidentDetail.summarized_offense_description}}</td> <td>{{incidentDetail.zone_beat}}</td> </tr> </tbody> </table> </div> </div> <div class="col-md-5"> <div id="street-view-detail"></div> <button type="button" class="btn btn-primary" ng-click="closeDetail()"> <span class="glyphicon glyphicon-remove"></span> Close Detail </button> </div>'),$templateCache.put("views/template-map-canvas.html",'<div id="map-canvas"></div>'),$templateCache.put("views/template-reports-block.html",""),$templateCache.put("views/template-reports-summary.html",'<div class="panel panel-default" ng-show="$typeDetail.data !== null"> <!-- Default panel contents --> <div class="panel-heading">Incident Type Summary</div> <div class="panel-body"> <table class="table"> <thead> <tr> <th>Offense Category</th> <th></th> <th>Offense Count</th> <th>% of Total Incidents</th> <th>Child types</th> <th></th> </tr> </thead> <tbody> <td> {{$typeDetail.data.offenseCategory}} </td> <td> <span class="badge" style="background-color: {{$typeDetail.data.fillColor}}">&nbsp;</span> </td> <td> {{$typeDetail.data.count}} </td> <td> {{ ($typeDetail.data.count / $reports.length) * 100 | number:0 }} </td> <td> <ul> <li ng-repeat="(key, value) in $typeDetail.data.children | orderObjectBy : \'count\' : true" class="list-unstyled"> {{value.$type}} {{value.count}} </li> </ul> </td> <td width="33%"> <ul> <li ng-repeat="(key, value) in $typeDetail.data.children | orderObjectBy : \'count\' : true" class="list-unstyled"> <div class="reportTotals" style="background-color: {{$typeDetail.data.fillColor}}; width: {{value.count / 10}}%">&nbsp;</div> </li> </ul> </td> </tbody> </table> <div class="btn-group" role="group"> <button type="button" class="btn btn-default" ng-click="filterTypeDetail($event)"><span class="glyphicon glyphicon-filter"></span></button> <button type="button" class="btn btn-default" ng-click="clearTypeDetail($event)"><span class="glyphicon glyphicon-remove"></span></button> </div> </div> </div>'),$templateCache.put("views/template-reports-viz.html",'<div id="cicle-tool-tip"></div>'),$templateCache.put("views/template-summary-list.html",'<ul class="list-unstyled"> <li ng-repeat="(key, val) in $index | orderObjectBy : \'count\' : true"> <div class="reportTotals" style="background-color: {{val.fillColor}}; width: {{val.count / 10}}%"></div> {{val.offenseCategory}} <span class="badge">{{val.count}}</span> <span ng-repeat="child in val.children">{{child.$type}}&nbsp;&nbsp;{{child.count}}&nbsp;&nbsp;</span> </li> </ul>')}]);