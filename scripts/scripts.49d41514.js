"use strict";angular.module("mkm.seaCrimeData",["ngRoute","ngMaterial"]).service("seattleDataGov",["$http","$q",function($http,$q){function processIncidentData(data){function indexUpdate(_report_){function updateIndex(typeStr,currentChildren){if("VEH-THEFT-AUTO"!==typeStr)for(var newChildren=getChildType(typeStr),i=newChildren.length-1;i>=0;i--){var childType=newChildren[i];currentChildren.hasOwnProperty(childType)?currentChildren[childType].count++:currentChildren[childType]={$type:childType,count:1}}return currentChildren}function getChildType(typeStr){for(var q=typeStr,childTypes=[];-1!==q.lastIndexOf("-");)childTypes.push(q.slice(q.lastIndexOf("-")+1,q.length)),q=q.slice(0,q.lastIndexOf("-"));return childTypes}var offType=_report_.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));if(_index_.hasOwnProperty(parentType)){var childrenNow=_index_[parentType].children;_index_[parentType].children=updateIndex(offType,childrenNow),_index_[parentType].count++}else void 0!==parentType&&(_index_[parentType]={count:1,offenseCategory:"VEH-THEFT-AUTO"===offType?offType:parentType,show:!0,children:null},_index_[parentType].children=updateIndex(offType,{}))}function plotsAddReport(_report_){var _longitude=Number(_report_.longitude),_latitude=Number(_report_.latitude);isNaN(_longitude)||isNaN(_latitude)||(_mapBounds.extend(new google.maps.LatLng(_latitude,_longitude)),_plots_.push({type:"Feature",geometry:{type:"Point",coordinates:[_longitude,_latitude]},properties:_report_}))}function setIndexColors(){var d3Colour=d3.scale.category20().domain(d3.keys(_index_));for(var key in _index_)_index_[key].fillColor=d3Colour(key)}for(var _index_={},_plots_=[],i=data.length-1;i>=0;i--)plotsAddReport(data[i]),indexUpdate(data[i]);return setIndexColors(),{reports:_plots_,index:_index_}}var _mapBounds=new google.maps.LatLngBounds,_http=$http({method:"GET",url:"https://data.seattle.gov/resource/7ais-f98f.json"}),_promise=$q.defer();return _http.then(function(response){var processedData=processIncidentData(response.data);_promise.resolve({incidents:processedData.reports,index:processedData.index,mapBounds:_mapBounds})}),_promise}]).directive("filterReportTypes",[function(){return{templateUrl:"views/template-crime-map-filter.html",scope:{filterInd:"=filterReportTypes",filterMap:"=crimeMapFilter",filterTime:"=crimeTimelineFilter"},link:function(scope){console.log(scope),scope.updated=!1,scope.filterPushSplice=function($event){$event.preventDefault(),$event.cancelBubble=!0,this.val.show=!this.val.show,scope.updated=!0},scope.filterApply=function($event){$event.preventDefault();var _index=this.mapIndexFilter();scope.filterMap.update(_index),scope.filterTime.filterData(_index),scope.updated=!1},scope.filterClear=function($event){$event.preventDefault(),$event.cancelBubble=!0;for(var key in scope.filterInd)scope.filterInd[key].show=!1;scope.updated=!1},scope.filterReset=function($event){$event.preventDefault(),$event.cancelBubble=!0;for(var key in scope.filterInd)scope.filterInd[key].show=!0;scope.updated=!0},scope.mapIndexFilter=function(){var _index_=scope.filterInd||{},filteredArray=[];for(var key in _index_)_index_[key].show||filteredArray.push(key);return filteredArray}}}}]).directive("summaryList",[function(){return{templateUrl:"views/template-summary-list.html"}}]).directive("crimeReportsSummary",[function(){function link(scope,element){var summaryType=element.attr("crime-reports-summary"),summaryIndex=element.attr("summary-index");scope[summaryType]={data:null,filtered:!1,renderChart:function(reportTypes){scope[summaryType].data=reportTypes,scope.$apply()}},scope.clearTypeDetail=function(){scope[summaryType].data=null},scope.filterTypeDetail=function($event){if(scope[summaryType].filtered=!scope[summaryType].filtered,scope[summaryType].filtered){var d=scope[summaryType].data,offenseCategory="VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory;scope.filterClear($event),scope[summaryIndex][offenseCategory].show=!0,scope.filterApply($event)}else scope.filterReset($event),scope.filterApply($event)}}return{link:link,templateUrl:"/views/template-reports-summary.html"}}]).directive("incidentDetail",[function(){function link(scope,element){var vizID=element.attr("timeline-id");scope.incidentDetail=null,null!==document.getElementById("street-view-detail")&&(scope.$detailMap=new google.maps.Map(document.getElementById("street-view-detail"),{zoom:14})),scope.closeDetail=function(){try{scope.mapID.$markers.close()}catch(e){}scope[vizID].toolTipHide(),this.incidentDetail=null}}return{link:link,templateUrl:"views/template-incident-detail.html"}}]).filter("orderObjectBy",function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){return a[field]>b[field]?1:-1}),reverse&&filtered.reverse(),filtered}}),angular.module("mkm.seaCrimeData").directive("crimeReportsBlock",["$window",function($window){return console.log($window),{templateUrl:"views/template-reports-block.html",scope:{$promise:"=crimeReportsData"},link:function(scope,element){var $elm=element[0],wrapper=d3.select($elm),padding=.033*$elm.offsetWidth,wdth=$elm.offsetWidth,hght=$elm.offsetHeight,barHght=hght-padding-120,svg=wrapper.append("svg").attr({height:hght,width:wdth}),scaleAxisX=d3.scale.ordinal().rangeBands([padding,wdth-padding]),scaleAxisY=d3.scale.linear().range([padding,barHght]);scope.$promise.promise.then(function(data){function setTypeDetail(d){scope.$typeDetail.renderChart(d)}function _refreshBlocks(){var padding=.025*$elm.offsetWidth,wdth=$elm.offsetWidth,hght=$elm.offsetHeight,barHght=.75*hght;svg.attr({height:hght,width:wdth}),scaleAxisX.rangeBands([padding,wdth-padding]),scaleAxisY.range([padding,barHght]),indexRect.selectAll(".block-label.category").transition().duration(100).ease("sin-in-out").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.33*scaleAxisX.rangeBand())+", "+(barHght-padding+7)+") rotate(-50)"}),indexRect.selectAll(".block-label.count").transition().duration(100).ease("sin-in-out").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.67*scaleAxisX.rangeBand()-4)+", "+(barHght-scaleAxisY(d.count)-padding-2)+")"}),indexRect.selectAll("g.reports-index-rect rect").transition().duration(100).ease("sin-in-out").attr("transform",function(d){var scaleVal=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+scaleVal+","+2*(barHght-padding)+") rotate(180)"}).attr("y",function(){return barHght-padding}).attr("width",scaleAxisX.rangeBand()).attr("height",function(d){return scaleAxisY(d.count)})}var _index_=data.index,indexArr=[];for(var ind in _index_)indexArr.push(_index_[ind]);var indexSorted=indexArr.sort(function(a,b){return a.count>b.count?1:a.count<b.count?-1:0}),axisTitles=[];indexSorted.forEach(function(d){axisTitles.push("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory)}),scaleAxisX.domain(axisTitles.reverse()),scaleAxisY.domain([0,d3.max(indexSorted,function(d){return d.count})]);var indexRect=svg.selectAll("g.reports-index-rect").data(indexSorted).enter().append("g").attr("id",function(d){return d.offenseCategory}).attr("class","reports-index-rect").attr("transform","translate("+padding+",80)");indexRect.append("rect").attr("transform",function(d){var scaleVal=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+scaleVal+","+2*(barHght-padding)+") rotate(180)"}).attr("y",function(){return barHght-padding}).attr("width",scaleAxisX.rangeBand()).attr("height",function(d){return scaleAxisY(d.count)}).attr("fill",function(d){return d.fillColor}).on("click",setTypeDetail),indexRect.append("text").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.33*scaleAxisX.rangeBand())+", "+(barHght-padding+9)+") rotate(-33)"}).attr("text-anchor","end").attr("class","block-label category").text(function(d){return d.offenseCategory}).on("click",setTypeDetail),indexRect.append("text").attr("transform",function(d){var xTrans=scaleAxisX("VEH-THEFT-AUTO"===d.offenseCategory?"VEH":d.offenseCategory);return"translate("+(xTrans-.67*scaleAxisX.rangeBand()-4)+", "+(barHght-scaleAxisY(d.count)-padding-2)+")"}).attr("class","block-label count").text(function(d){return d.count}).on("click",setTypeDetail),scope.blockID={refreshBlocks:_refreshBlocks},angular.element($window).bind("resize",_refreshBlocks)})}}}]),angular.module("mkm.seaCrimeData").directive("vizTimeLine",["$window",function($window){return{templateUrl:"views/template-reports-viz.html",scope:{vizID:"=vizTimeLine",mapID:"=crimeVizMap",promiseAttr:"=vizTimeData"},link:function(scope,element){function radiusCalc(_el_){var elWdth=_el_.offsetWidth,rad=8;return elWdth>600?rad=16:elWdth>1280&&(rad=20),rad}function paddingCalc(_el_){var elWdth=_el_.offsetWidth,pad=3;return elWdth>600?pad=16:elWdth>1280&&(pad=24),pad}var elm=element[0],wrapper=d3.select(elm),padding=paddingCalc(elm),wdth=elm.offsetWidth,hght=elm.offsetHeight,padRange={x:function(_wdth_){return[padding+60,_wdth_-padding]},y:function(_hght_){return[padding,_hght_-padding-36]}},svg=wrapper.append("svg").attr({height:hght,width:wdth}),scaleAxisX=d3.time.scale().range(padRange.x(wdth)),scaleAxisY=d3.time.scale.utc().domain([new Date("Wed Dec 31 1969 00:00:00 GMT-0800 (PST)"),new Date("Wed Dec 31 1969 23:59:00 GMT-0800 (PST)")]).range(padRange.y(hght)),xAxis=d3.svg.axis().orient("bottom").ticks(d3.time.day,1).innerTickSize(-wdth).outerTickSize(0).tickPadding(10).tickFormat(d3.time.format("%a %m/%d")),yAxis=d3.svg.axis().orient("left").innerTickSize(-(hght+padding)).outerTickSize(0).tickPadding(10).tickFormat(d3.time.format("%H:%M")).ticks(d3.time.hours,3);scope.toolTipLock=scope.toolTipLock||!1,scope.promiseAttr.promise.then(function(data){function setCircStyle(currentState,d){var offType=d.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),colour=_index[parentType].fillColor;switch(currentState){case"initial":return"stroke: "+colour+"; stroke-width: 2px; fill-opacity: 0; stroke-opacity: .67";case"mouseover":return"fill: "+colour+"; stroke-width: 0px; fill-opacity: 1; stroke-opacity: .67";case"mouseout":return"stroke: "+colour+"; stroke-width: 2px; fill-opacity: 0; stroke-opacity: .67"}}function plotXcirc(d){var incidentDate=new Date(d.properties.date_reported),timeFormat=d3.time.format("%x");return scaleAxisX(new Date(timeFormat(incidentDate)))}function plotYcirc(d){var timeFormat=d3.time.format("%X"),incidentTime=timeFormat(new Date(d.properties.date_reported));return scaleAxisY(new Date("Wed Dec 31 1969 "+incidentTime))}function toolTipShow(data,element){try{scope.mapID.$markers.close()}catch(e){}var incident=data,circ=void 0!==element?element:reportMarks.selectAll("circle").filter(function(d){return d.properties.general_offense_number===incident.general_offense_number})[0][0];if("transparent"!==circ.getAttribute("fill")){var timeFormatFull=d3.time.format("%A at %H:%M"),parent=circ.parentElement,parentbounding=parent.getBoundingClientRect(),bounding=circ.getBoundingClientRect(),newWdth=bounding.left,newHght=bounding.top,toolTipHght=toolTipEl[0][0].getBoundingClientRect().height,offsetX=newWdth-parentbounding.left,offsetY=newHght-parentbounding.top+toolTipHght+24;toolTipEl.html(timeFormatFull(new Date(incident.date_reported))+" / "+incident.offense_type),toolTipEl.style("left",function(){return offsetX+"px"}).style("top",function(){return offsetY+"px"}),toolTipEl.transition().duration(200).style("opacity",1).style("background",function(){var offType=incident.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));return _index[parentType].fillColor}).attr("transform","translate("+padding+","+(hght-30)+")")}}function toolTipHide(){toolTipEl.transition().duration(500).style("opacity",0),reportMarks.selectAll("circle").transition().duration(250),scope.toolTipLock=!1;try{scope.mapID.$markers.close()}catch(e){}}function _refreshTimeLine(){var newWdth=elm.offsetWidth,newHght=elm.offsetHeight;svg.attr({height:newHght,width:newWdth}),scaleAxisX.range(padRange.x(newWdth)),scaleAxisY.range(padRange.y(newHght)),svg.select("g#reports-vz-marks").transition().duration(100).attr("transform","translate(0, 0)"),svg.select(".axis.x").transition().duration(100).attr("transform","translate(0,"+(newHght-30)+")").ease("sin-in-out").call(xAxis),svg.select(".axis.y").attr("transform","translate(50, 0)").transition().duration(100).ease("sin-in-out").call(yAxis),reportMarks.selectAll("circle").transition().duration(200).attr("cx",plotXcirc).attr("cy",plotYcirc)}var toolTipEl=d3.select("#cicle-tool-tip"),_incidents=data.incidents,_index=data.index,dateRange=d3.extent(_incidents,function(d){return new Date(d.properties.date_reported)});scaleAxisX.domain(dateRange),xAxis.scale(scaleAxisX),yAxis.scale(scaleAxisY),svg.append("g").attr("class","axis x").attr("transform","translate(0,"+(hght-30)+")").call(xAxis),svg.append("g").attr("class","axis y").attr("transform","translate(50, 0)").call(yAxis);var reportMarks=svg.append("g").attr("id","reports-vz-marks").attr("transform","translate(0, 0)");reportMarks.selectAll("circle").data(_incidents).enter().append("circle").attr("class","timeline-circle").attr("style",function(d){return setCircStyle("initial",d)}).attr("cx",plotXcirc).attr("cy",plotYcirc).attr("r",radiusCalc(element)).on("click",function(event){toolTipShow(event.properties,this),scope.toolTipLock=!0;var offType=event.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),_latitude=Number(event.properties.latitude),_longitude=Number(event.properties.longitude),uluru={lat:_latitude,lng:_longitude};null!==scope.mapID.markers&&scope.mapID.markers.setMap(null);var _marker=new google.maps.Marker({position:uluru,map:scope.mapID.$g,icon:"images/spacer.png"}),_HTMLcontent='<span class="glyphicon glyphicon-map-marker" style="color: '+scope.$index[parentType].fillColor+'"></span>&nbsp;'+event.properties.summarized_offense_description,infowindow=new google.maps.InfoWindow({content:_HTMLcontent});if(infowindow.open(scope.mapID.$g,_marker),google.maps.event.addListener(infowindow,"closeclick",function(){scope.incidentDetail=null,scope.$apply(),toolTipHide()}),scope.mapID.$g.setCenter(_marker.getPosition()),scope.mapID.$markers=infowindow,scope.incidentDetail=event.properties,scope.$apply(),void 0!==scope.$detailMap){var StreetView=new google.maps.Map(document.getElementById("street-view-detail"),{scrollwheel:!1,zoomControl:!1,zoom:0}),panorama=new google.maps.StreetViewPanorama(document.getElementById("street-view-detail"),{position:uluru,pov:{heading:34,pitch:5},scrollwheel:!1});StreetView.setStreetView(panorama)}}).on("mouseover",function(d){scope.toolTipLock||(this.setAttribute("style",setCircStyle("mouseover",d)),toolTipShow(d.properties,this))}).on("mouseout",function(d){scope.toolTipLock||(this.setAttribute("style",setCircStyle("mouseout",d)),toolTipHide())}),scope.vizID={filterData:function(filterIndex){reportMarks.selectAll("circle").transition().duration(200).attr("cx",function(d){var offType=d.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));if(filterIndex.indexOf(parentType)<0){var incidentDate=new Date(d.properties.date_reported).toDateString(),_q_=scaleAxisX(new Date(incidentDate));return _q_}return-12e18}).attr("fill",function(d){var offType=d.properties.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));return filterIndex.indexOf(parentType)<0?_index[parentType].fillColor:"transparent"})},refresh:_refreshTimeLine,toolTipHide:function(){toolTipHide()},toolTipShow:function(incident){toolTipShow(incident)}},angular.element($window).bind("resize",function(){_refreshTimeLine()})})}}}]),angular.module("mkm.seaCrimeData").directive("mapCanvas",["$window",function($window){return{templateUrl:"views/template-map-canvas.html",scope:{$promise:"=mapPromise",vizID:"=mapTimeline"},link:function($scope){$scope.mapID={$g:null},$scope.$promise.promise.then(function(data){function plotstyleBasic(feature){if(void 0!==$scope.mapID.$g&&void 0!==$scope.mapID.$g){var offType=feature.f.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),offense=$scope.$parent.$index[parentType];return{icon:{path:google.maps.SymbolPath.CIRCLE,scale:3,fillColor:offense.fillColor,fillOpacity:1,strokeWeight:0}}}}function markerClick(event){$scope.toolTipLock=!0;var currentFiltered=$scope.mapIndexFilter(),offType=event.feature.f.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-"));if(-1===currentFiltered.indexOf(parentType)){var _incident=event.feature.f,_latitude=Number(_incident.latitude),_longitude=Number(_incident.longitude),uluru={lat:_latitude,lng:_longitude};null!==$scope.mapID.markers&&$scope.mapID.markers.setMap(null);var _marker=new google.maps.Marker({position:uluru,map:$scope.mapID.$g,icon:"images/spacer.png"}),_HTMLcontent='<span class="glyphicon glyphicon-map-marker" style="color: '+$scope.$parent.$index[parentType].fillColor+'"></span>&nbsp;'+_incident.summarized_offense_description,infowindow=new google.maps.InfoWindow({content:_HTMLcontent});if(infowindow.open($scope.mapID.$g,_marker),google.maps.event.addListener(infowindow,"closeclick",function(){$scope.incidentDetail=null,$scope.$apply(),$scope.vizID.toolTipHide()}),$scope.mapID.$g.setCenter(_marker.getPosition()),$scope.mapID.markers=infowindow,$scope.incidentDetail=_incident,$scope.$apply(),$scope.vizID.toolTipShow(_incident),void 0!==$scope.$detailMap){var StreetView=new google.maps.Map(document.getElementById("street-view-detail"),{scrollwheel:!1,zoomControl:!1,zoom:0}),panorama=new google.maps.StreetViewPanorama(document.getElementById("street-view-detail"),{position:uluru,pov:{heading:34,pitch:5},scrollwheel:!1});StreetView.setStreetView(panorama)}}}$scope.toolTipLock=$scope.toolTipLock||!1,$scope.mapID.markers=null,$scope.markerOver=null,$scope.mapID.refresh=function(){$scope.mapID.$g.fitBounds(data.mapBounds)},$scope.mapID.$g=new google.maps.Map(document.getElementById("map-canvas"),{scrollwheel:!1,streetViewControl:!1,mapTypeControl:!1,panControl:!1}),$scope.mapID.$g.setOptions({styles:[{stylers:[{hue:"#fff"},{saturation:-100}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"on"}]}]}),$scope.mapID.$g.data.addGeoJson({type:"FeatureCollection",features:data.incidents}),$scope.mapID.$g.data.setStyle(plotstyleBasic),$scope.mapID.$g.data.addListener("click",function($event){markerClick($event)}),$scope.mapID.$g.fitBounds(data.mapBounds),$scope.mapID.update=function(indexArray){function indexSelected(feature){var offType=feature.f.offense_type,parentType=-1===offType.indexOf("-")?offType:offType.slice(0,offType.indexOf("-")),filterOffence=indexArray.indexOf(parentType)>-1,offenseHex=$scope.$parent.$index[parentType].fillColor;return{icon:{path:google.maps.SymbolPath.CIRCLE,scale:2.75,fillColor:filterOffence?"transparent":offenseHex,fillOpacity:filterOffence?0:1,strokeWeight:0,zIndex:filterOffence?100:1}}}$scope.mapID.$g.data.setStyle(indexSelected)},angular.element($window).bind("resize",function(){$scope.mapID.$g.fitBounds(data.mapBounds)})})}}}]),angular.module("mkm.seaCrimeData").config(["$routeProvider",function($routeProvider){$routeProvider.when("/seattle-crime-map",{templateUrl:"views/crime-view.html",controller:"CrimeMapCtrl"}).otherwise({redirectTo:"/seattle-crime-map"})}]).controller("CrimeMapCtrl",["$scope","seattleDataGov",function($scope,seattleDataGov){$scope.crimeData=seattleDataGov,$scope.crimeData.promise.then(function(data){$scope.$index=data.index,$scope.$reports=data.incidents})}]),angular.module("mkm.seaCrimeData").run(["$templateCache",function($templateCache){$templateCache.put("views/crime-view.html",'<div layout="row" layout-wrap> <div flex> <div filter-report-types="$index" crime-timeline-filter="$vizTimeline"></div> <div id="sea-crime-viz" viz-time-line="$vizTimeline" viz-time-data="crimeData" crime-viz-map="$crimeMap"></div> </div> <div flex="100" flex-md="40" flex-gt-md="20"> <!-- GOOGLE MAP --> <div map-canvas="$crimeMap" map-promise="crimeData" map-timeline="$vizTimeline"></div> </div> <!-- TIMELINE --> <!-- <div flex>\n    <!-- INCIDENT DETAIL\n    <div crime-reports-summary="$typeDetail" summary-index="$index"></div>\n  </div>\n   --> <div flex="100" flex-gt-md="40" hide-sm hide-xs> <!-- BAR CHART --> <div id="crime-reports-block" crime-reports-block crime-reports-data="crimeData"></div> </div> </div>'),$templateCache.put("views/template-crime-map-filter.html",'<md-menu> <md-button aria-label="Filter crime data" class="md-icon-button" ng-click="$mdOpenMenu($event)"> <span class="glyphicon glyphicon-filter"></span> </md-button> <md-menu-content width="8"> <md-menu-item> <md-button ng-click="filterApply($event)">Apply </md-button></md-menu-item> <md-menu-item> <md-button ng-click="filterReset($event)" ng-disabled="!mapIndexFilter().length > 0" md-prevent-menu-close>Reset </md-button></md-menu-item> <md-menu-item> <md-button ng-click="filterClear($event)" ng-disabled="$indexLength() === mapIndexFilter().length" md-prevent-menu-close>Clear All </md-button></md-menu-item> <md-menu-divider></md-menu-divider> <md-menu-item ng-repeat="(key, val) in filterInd | orderObjectBy : \'count\' : true"> <md-button ng-click="filterPushSplice($event)" ng-class="{\'md-primary\' : val.show}" md-prevent-menu-close> {{val.offenseCategory}} <span class="badge" style="background-color: {{val.fillColor}}">&nbsp;</span> </md-button> </md-menu-item> </md-menu-content> </md-menu>'),$templateCache.put("views/template-incident-detail.html",'<div class="col-md-5 col-md-offset-1"> <div class="table-responsive"> <table class="table"> <thead> <tr> <td>Date Reported</td> <td>Address</td> <td>District Sector</td> <td>Census Tract</td> <td>General Offense Number</td> <td>Offense Type</td> <td>Offense Code</td> <td>Description</td> <td>Zone/Beat</td> </tr> </thead> <tbody> <tr> <td>{{incidentDetail.date_reported | date:\'medium\'}}</td> <td>{{incidentDetail.hundred_block_location}}</td> <td>{{incidentDetail.district_sector}}</td> <td>{{incidentDetail.census_tract_2000}}</td> <td>{{incidentDetail.general_offense_number}}</td> <td>{{incidentDetail.offense_type}}</td> <td>{{incidentDetail.offense_code}}</td> <td>{{incidentDetail.summarized_offense_description}}</td> <td>{{incidentDetail.zone_beat}}</td> </tr> </tbody> </table> </div> </div> <div class="col-md-5"> <div id="street-view-detail"></div> <button type="button" class="btn btn-primary" ng-click="closeDetail()"> <span class="glyphicon glyphicon-remove"></span> Close Detail </button> </div>'),$templateCache.put("views/template-map-canvas.html",'<div id="map-canvas"></div>'),$templateCache.put("views/template-reports-block.html",""),$templateCache.put("views/template-reports-summary.html",'<div class="panel panel-default" ng-show="$typeDetail.data !== null"> <!-- Default panel contents --> <div class="panel-heading">Incident Type Summary</div> <div class="panel-body"> <table class="table"> <thead> <tr> <th>Offense Category</th> <th></th> <th>Offense Count</th> <th>% of Total Incidents</th> <th>Child types</th> <th></th> </tr> </thead> <tbody> <td> {{$typeDetail.data.offenseCategory}} </td> <td> <span class="badge" style="background-color: {{$typeDetail.data.fillColor}}">&nbsp;</span> </td> <td> {{$typeDetail.data.count}} </td> <td> {{ ($typeDetail.data.count / $reports.length) * 100 | number:0 }} </td> <td> <ul> <li ng-repeat="(key, value) in $typeDetail.data.children | orderObjectBy : \'count\' : true" class="list-unstyled"> {{value.$type}} {{value.count}} </li> </ul> </td> <td width="33%"> <ul> <li ng-repeat="(key, value) in $typeDetail.data.children | orderObjectBy : \'count\' : true" class="list-unstyled"> <div class="reportTotals" style="background-color: {{$typeDetail.data.fillColor}}; width: {{value.count / 10}}%">&nbsp;</div> </li> </ul> </td> </tbody> </table> <div class="btn-group" role="group"> <button type="button" class="btn btn-default" ng-click="filterTypeDetail($event)"><span class="glyphicon glyphicon-filter"></span></button> <button type="button" class="btn btn-default" ng-click="clearTypeDetail($event)"><span class="glyphicon glyphicon-remove"></span></button> </div> </div> </div>'),$templateCache.put("views/template-reports-viz.html",'<div id="cicle-tool-tip"></div>'),$templateCache.put("views/template-summary-list.html",'<ul class="list-unstyled"> <li ng-repeat="(key, val) in $index | orderObjectBy : \'count\' : true"> <div class="reportTotals" style="background-color: {{val.fillColor}}; width: {{val.count / 10}}%"></div> {{val.offenseCategory}} <span class="badge">{{val.count}}</span> <span ng-repeat="child in val.children">{{child.$type}}&nbsp;&nbsp;{{child.count}}&nbsp;&nbsp;</span> </li> </ul>')}]);